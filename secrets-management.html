<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Secrets management guide - secure credentials, API keys, and sensitive configuration. Environment variables, .env files, and secrets managers.">
    <meta name="keywords" content="secrets management, secure credentials, API key security, environment variables, .env security, HashiCorp Vault, AWS Secrets Manager, credential security">
    <title>Secrets & Credential Management - RmVuln</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header class="content-header">
        <div class="container">
            <h1>Secrets & Credential Management</h1>
            <p>Secure your API keys, passwords, and sensitive configuration</p>
        </div>
    </header>

    <div style="width: 100%; height: 250px; overflow: hidden;">
        <img src="https://images.unsplash.com/photo-1633265486064-086b219458ec?w=1600&h=250&fit=crop"
             alt="Security keys and credentials protection"
             style="width: 100%; height: 100%; object-fit: cover;">
    </div>

    <main class="container">
        <div class="content-wrapper">
            <div class="info-box">
                <strong>Why Secrets Management Matters:</strong> Exposed credentials are the #1 cause of data breaches. API keys, database passwords, and encryption keys accidentally committed to Git or hardcoded in source code lead to devastating compromises.
            </div>

            <h2>What NOT to Do</h2>

            <div class="vuln-item">
                <h2>1. Never Hardcode Secrets</h2>

                <div class="warning-box">
                    <strong>NEVER do this:</strong>
                </div>

                <div class="code-block">
                    <code># BAD - Hardcoded credentials in source code
database_password = "SuperSecret123!"
api_key = "sk-1234567890abcdef"

# BAD - Credentials in config files committed to Git
# config.py
DB_HOST = "localhost"
DB_USER = "admin"
DB_PASS = "password123"  # NEVER!

# BAD - Connection strings with embedded passwords
connection_string = "mysql://root:password@localhost/mydb"</code>
                </div>

                <h3>What Attackers Find in Public Git Repos</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Secret Type</th>
                            <th>Risk Level</th>
                            <th>Impact</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>AWS Access Keys</td>
                            <td>Critical</td>
                            <td>Full cloud account takeover, crypto mining</td>
                        </tr>
                        <tr>
                            <td>Database Passwords</td>
                            <td>Critical</td>
                            <td>Complete data breach</td>
                        </tr>
                        <tr>
                            <td>API Keys (Stripe, Twilio)</td>
                            <td>High</td>
                            <td>Financial fraud, service abuse</td>
                        </tr>
                        <tr>
                            <td>JWT Secrets</td>
                            <td>Critical</td>
                            <td>Token forgery, authentication bypass</td>
                        </tr>
                        <tr>
                            <td>SSH Private Keys</td>
                            <td>Critical</td>
                            <td>Server access, lateral movement</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h2>Environment Variables</h2>

            <div class="vuln-item">
                <h2>2. Use Environment Variables</h2>

                <h3>Setting Environment Variables</h3>
                <div class="code-block">
                    <code># Linux/macOS - Temporary (current session)
export DATABASE_PASSWORD="SecurePassword123!"
export API_KEY="sk-1234567890abcdef"

# Linux/macOS - Permanent (add to ~/.bashrc or ~/.zshrc)
echo 'export DATABASE_PASSWORD="SecurePassword123!"' >> ~/.bashrc
source ~/.bashrc

# Windows Command Prompt
set DATABASE_PASSWORD=SecurePassword123!

# Windows PowerShell
$env:DATABASE_PASSWORD = "SecurePassword123!"

# Windows - Permanent (System Properties > Environment Variables)
setx DATABASE_PASSWORD "SecurePassword123!"</code>
                </div>

                <h3>Reading Environment Variables in Code</h3>
                <div class="code-block">
                    <code># Python
import os
db_password = os.environ.get('DATABASE_PASSWORD')
api_key = os.getenv('API_KEY', 'default_value')

# Node.js
const dbPassword = process.env.DATABASE_PASSWORD;
const apiKey = process.env.API_KEY || 'default_value';

# PHP
$db_password = getenv('DATABASE_PASSWORD');
$api_key = $_ENV['API_KEY'] ?? 'default_value';

# Java
String dbPassword = System.getenv("DATABASE_PASSWORD");

# C# / .NET
string dbPassword = Environment.GetEnvironmentVariable("DATABASE_PASSWORD");

# Go
dbPassword := os.Getenv("DATABASE_PASSWORD")

# Ruby
db_password = ENV['DATABASE_PASSWORD']</code>
                </div>
            </div>

            <h2>.env Files</h2>

            <div class="vuln-item">
                <h2>3. Using .env Files Securely</h2>

                <h3>Create .env File</h3>
                <div class="code-block">
                    <code># .env file (in project root)
DATABASE_HOST=localhost
DATABASE_PORT=5432
DATABASE_NAME=myapp
DATABASE_USER=app_user
DATABASE_PASSWORD=SecurePassword123!

API_KEY=sk-1234567890abcdef
JWT_SECRET=super-secret-jwt-key-change-this

# AWS Credentials
AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMPLE
AWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY

# Third-party APIs
STRIPE_SECRET_KEY=sk_live_xxxxxxxxxxxxx
SENDGRID_API_KEY=SG.xxxxxxxxxxxxxxxxxxxx</code>
                </div>

                <div class="warning-box">
                    <strong>CRITICAL: Add .env to .gitignore!</strong>
                </div>

                <h3>.gitignore Configuration</h3>
                <div class="code-block">
                    <code># .gitignore - MUST include these
.env
.env.local
.env.*.local
.env.production
.env.development

# Also ignore
*.pem
*.key
*.p12
config/secrets.yml
config/credentials.yml.enc

# IDE files that might contain secrets
.idea/
.vscode/settings.json</code>
                </div>

                <h3>Loading .env Files</h3>
                <div class="code-block">
                    <code># Python - using python-dotenv
pip install python-dotenv

from dotenv import load_dotenv
import os

load_dotenv()  # Loads .env file
db_password = os.getenv('DATABASE_PASSWORD')

# Node.js - using dotenv
npm install dotenv

require('dotenv').config();
const dbPassword = process.env.DATABASE_PASSWORD;

# PHP - using vlucas/phpdotenv
composer require vlucas/phpdotenv

$dotenv = Dotenv\Dotenv::createImmutable(__DIR__);
$dotenv->load();
$dbPassword = $_ENV['DATABASE_PASSWORD'];

# Ruby - using dotenv
gem install dotenv

require 'dotenv/load'
db_password = ENV['DATABASE_PASSWORD']</code>
                </div>

                <h3>Create .env.example Template</h3>
                <div class="code-block">
                    <code># .env.example (commit this to Git as a template)
DATABASE_HOST=localhost
DATABASE_PORT=5432
DATABASE_NAME=myapp
DATABASE_USER=
DATABASE_PASSWORD=

API_KEY=
JWT_SECRET=

# Instructions for developers:
# 1. Copy this file to .env
# 2. Fill in the actual values
# 3. NEVER commit .env to Git</code>
                </div>
            </div>

            <h2>Secret Scanning</h2>

            <div class="vuln-item">
                <h2>4. Scan for Leaked Secrets</h2>

                <h3>git-secrets (AWS)</h3>
                <div class="code-block">
                    <code># Install git-secrets
brew install git-secrets  # macOS
# or
git clone https://github.com/awslabs/git-secrets.git
cd git-secrets && make install

# Set up in repository
cd your-repo
git secrets --install
git secrets --register-aws

# Scan existing commits
git secrets --scan-history

# Add to pre-commit hook (automatic scanning)
git secrets --install</code>
                </div>

                <h3>TruffleHog</h3>
                <div class="code-block">
                    <code># Install TruffleHog
pip install trufflehog

# Scan Git repository
trufflehog git https://github.com/user/repo.git

# Scan local directory
trufflehog filesystem /path/to/project

# Scan with JSON output
trufflehog git https://github.com/user/repo.git --json</code>
                </div>

                <h3>Gitleaks</h3>
                <div class="code-block">
                    <code># Install Gitleaks
brew install gitleaks  # macOS
# or download from GitHub releases

# Scan repository
gitleaks detect --source /path/to/repo

# Scan and generate report
gitleaks detect --source /path/to/repo --report-path report.json

# Use in CI/CD
gitleaks detect --source . --verbose</code>
                </div>

                <h3>GitHub Secret Scanning</h3>
                <p>GitHub automatically scans public repos for known secret patterns and alerts you. Enable in: Repository Settings → Security & Analysis → Secret Scanning</p>
            </div>

            <h2>Secrets Managers</h2>

            <div class="vuln-item">
                <h2>5. Use a Secrets Manager (Production)</h2>

                <h3>HashiCorp Vault</h3>
                <div class="code-block">
                    <code># Install Vault
brew install vault  # macOS

# Start dev server (testing only)
vault server -dev

# Store a secret
vault kv put secret/myapp/database password="SecurePass123!"

# Retrieve a secret
vault kv get secret/myapp/database

# Use in application (Python)
import hvac

client = hvac.Client(url='https://vault.example.com:8200')
client.token = 'your-vault-token'

secret = client.secrets.kv.read_secret_version(path='myapp/database')
db_password = secret['data']['data']['password']</code>
                </div>

                <h3>AWS Secrets Manager</h3>
                <div class="code-block">
                    <code># Create secret via AWS CLI
aws secretsmanager create-secret \
    --name myapp/database \
    --secret-string '{"username":"admin","password":"SecurePass123!"}'

# Retrieve secret via CLI
aws secretsmanager get-secret-value --secret-id myapp/database

# Python (boto3)
import boto3
import json

client = boto3.client('secretsmanager', region_name='us-east-1')
response = client.get_secret_value(SecretId='myapp/database')
secret = json.loads(response['SecretString'])
db_password = secret['password']

# Node.js
const AWS = require('aws-sdk');
const client = new AWS.SecretsManager({ region: 'us-east-1' });

const data = await client.getSecretValue({ SecretId: 'myapp/database' }).promise();
const secret = JSON.parse(data.SecretString);
const dbPassword = secret.password;</code>
                </div>

                <h3>Azure Key Vault</h3>
                <div class="code-block">
                    <code># Create Key Vault
az keyvault create --name myapp-vault --resource-group mygroup

# Store secret
az keyvault secret set --vault-name myapp-vault --name db-password --value "SecurePass123!"

# Retrieve secret
az keyvault secret show --vault-name myapp-vault --name db-password

# Python
from azure.identity import DefaultAzureCredential
from azure.keyvault.secrets import SecretClient

credential = DefaultAzureCredential()
client = SecretClient(vault_url="https://myapp-vault.vault.azure.net/", credential=credential)

secret = client.get_secret("db-password")
db_password = secret.value</code>
                </div>

                <h3>Google Cloud Secret Manager</h3>
                <div class="code-block">
                    <code># Create secret
echo -n "SecurePass123!" | gcloud secrets create db-password --data-file=-

# Access secret
gcloud secrets versions access latest --secret=db-password

# Python
from google.cloud import secretmanager

client = secretmanager.SecretManagerServiceClient()
name = "projects/my-project/secrets/db-password/versions/latest"
response = client.access_secret_version(request={"name": name})
db_password = response.payload.data.decode("UTF-8")</code>
                </div>
            </div>

            <h2>Docker Secrets</h2>

            <div class="vuln-item">
                <h2>6. Secrets in Containers</h2>

                <div class="warning-box">
                    <strong>Never put secrets in Dockerfiles or docker-compose.yml!</strong>
                </div>

                <h3>Docker Secrets (Swarm)</h3>
                <div class="code-block">
                    <code># Create secret
echo "SecurePass123!" | docker secret create db_password -

# Use in docker-compose.yml
version: '3.8'
services:
  app:
    image: myapp
    secrets:
      - db_password
    environment:
      - DB_PASSWORD_FILE=/run/secrets/db_password

secrets:
  db_password:
    external: true</code>
                </div>

                <h3>Kubernetes Secrets</h3>
                <div class="code-block">
                    <code># Create secret
kubectl create secret generic db-credentials \
    --from-literal=username=admin \
    --from-literal=password=SecurePass123!

# Or from file
kubectl create secret generic db-credentials --from-env-file=.env

# Use in Pod
apiVersion: v1
kind: Pod
metadata:
  name: myapp
spec:
  containers:
  - name: app
    image: myapp
    envFrom:
    - secretRef:
        name: db-credentials
    # Or individual keys
    env:
    - name: DB_PASSWORD
      valueFrom:
        secretKeyRef:
          name: db-credentials
          key: password</code>
                </div>
            </div>

            <h2>What To Do If Secrets Are Exposed</h2>

            <div class="vuln-item">
                <h2>7. Emergency Response</h2>

                <div class="code-block">
                    <code># 1. IMMEDIATELY rotate the exposed credential
#    - Generate new API key/password
#    - Update in secrets manager
#    - Deploy to production

# 2. Revoke the old credential
#    - Disable/delete old API keys
#    - Change passwords
#    - Rotate JWT secrets

# 3. Remove from Git history (if committed)
# Using BFG Repo-Cleaner (faster than git filter-branch)
brew install bfg

# Remove file containing secrets
bfg --delete-files .env

# Remove specific text
bfg --replace-text passwords.txt

# Clean up
git reflog expire --expire=now --all
git gc --prune=now --aggressive

# Force push (coordinate with team!)
git push --force

# 4. Audit for unauthorized access
#    - Check logs for API usage
#    - Review database access logs
#    - Check cloud provider activity logs

# 5. Scan entire codebase
gitleaks detect --source . --verbose
trufflehog filesystem .</code>
                </div>
            </div>

            <h2>Security Checklist</h2>
            <div class="success-box">
                <p>☐ No hardcoded secrets in source code<br>
                ☐ .env files added to .gitignore<br>
                ☐ .env.example template provided for developers<br>
                ☐ Environment variables used for configuration<br>
                ☐ Secret scanning enabled in CI/CD pipeline<br>
                ☐ Pre-commit hooks prevent secret commits<br>
                ☐ Production uses secrets manager (Vault, AWS, etc.)<br>
                ☐ Secrets rotated regularly<br>
                ☐ Least privilege access to secrets<br>
                ☐ Audit logging enabled for secret access<br>
                ☐ Emergency rotation procedure documented</p>
            </div>

            <div class="warning-box">
                <strong>Remember:</strong> If a secret is ever exposed (even briefly), treat it as compromised and rotate immediately. Attackers have automated tools scanning GitHub for secrets 24/7.
            </div>

            <a href="index.html" class="back-link">← Back to Tools</a>
        </div>
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2026 RmVuln. Quick reference for security professionals.</p>
            <p>For detailed guides: <a href="https://fixthevuln.com" target="_blank">FixTheVuln.com</a> | Support us: <a href="https://www.etsy.com/shop/BlizfulStore?ref=seller-platform-mcnav" target="_blank">Blizful Store</a></p>
            <p style="font-size: 0.85rem; color: #999; margin-top: 1rem;">
                <strong>Affiliate Disclosure:</strong> Some links on this site are affiliate links. We may earn a commission when you purchase through these links at no additional cost to you. We only recommend tools and services we trust.
            </p>
        </div>
    </footer>
</body>
</html>
